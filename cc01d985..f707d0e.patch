diff --git a/Project-3/myCPU/EX.v b/Project-3/myCPU/EX.v
index e4ee9f2..60eb68c 100644
--- a/Project-3/myCPU/EX.v
+++ b/Project-3/myCPU/EX.v
@@ -2,7 +2,7 @@ module EX(
         input   wire            clk,
         input   wire            rst,
         input   wire            MEM_allowin,
-        input   wire [181:0]    ID_to_EX_zip,
+        input   wire [188:0]    ID_to_EX_zip,
         output  wire            front_valid,
         output  wire [  4:0]    front_addr,
         output  wire [ 31:0]    front_data,
@@ -19,6 +19,13 @@ wire [11:0]     aluop;
 wire [40:0]     EX_to_MEM_zip;
 
 wire            inst_ld_w;
+wire            inst_mul;
+wire            inst_mulh;
+wire            inst_mulhu;
+wire            inst_div;
+wire            inst_divu;
+wire            inst_mod;
+wire            inst_modu;
 wire            mem_we;
 wire            res_from_mem;
 wire            gr_we;
@@ -29,17 +36,74 @@ assign front_valid = ~inst_ld_w & gr_we;
 assign front_addr = rf_waddr;
 assign front_data = alu_result;
 
-assign EX_allowin = ~valid | MEM_allowin;
+assign EX_allowin = ~valid | readygo & MEM_allowin;
 
 assign  {
-        valid, pc, IR, src1, src2, aluop, EX_to_MEM_zip
+        valid, pc, IR, src1, src2, aluop, EX_to_MEM_zip, 
+        inst_mul, inst_mulh, inst_mulhu, inst_div, inst_mod, inst_divu, inst_modu
 } = ID_to_EX_zip;
 
 assign {
         inst_ld_w, mem_we, res_from_mem, gr_we, rkd_value, rf_waddr
 } = EX_to_MEM_zip;
 
+
 wire [31:0]     alu_result;
+wire [31:0]     compute_result;
+wire [32:0]     mul_src1;
+wire [32:0]     mul_src2;
+wire [65:0]     prod;
+
+assign          mul_src1        = {~inst_mulhu & src1[31], src1};
+assign          mul_src2        = {~inst_mulhu & src2[31], src2};
+assign          prod            = $signed(mul_src1) * $signed(mul_src2);
+assign          compute_result  = inst_mul?                     prod[31:0]:
+                                  (inst_mulh | inst_mulhu)?     prod[63:32]:
+                                  inst_div?                     div_result[63:32]:
+                                  inst_mod?                     div_result[31:0]:
+                                  inst_divu?                    udiv_result[63:32]:
+                                  inst_modu?                    udiv_result[31:0]:
+                                  alu_result;
+
+wire            use_div;
+wire            use_udiv;
+wire            div_or_udiv;
+assign use_div = inst_div | inst_mod;
+assign use_udiv = inst_divu | inst_modu;
+assign div_or_udiv = use_div | use_udiv;
+
+wire [63:0]     div_result;
+wire            div_src_valid;
+wire            div_src_1_ready;
+wire            div_src_2_ready;
+wire            div_src_ready;
+wire            div_res_ready;
+wire            div_res_valid;
+assign div_src_ready = div_src_1_ready & div_src_2_ready;
+
+wire [63:0]     udiv_result;
+wire            udiv_src_valid;
+wire            udiv_src_1_ready;
+wire            udiv_src_2_ready;
+wire            udiv_src_ready;       
+wire            udiv_res_ready;
+wire            udiv_res_valid;
+assign udiv_src_ready = udiv_src_1_ready & udiv_src_2_ready;
+
+wire            src_ready;
+wire            res_valid;
+assign src_ready = use_div & div_src_ready | use_udiv & udiv_src_ready;
+assign res_valid = use_div & div_res_valid | use_udiv & udiv_res_valid;
+
+assign div_src_valid = wait_src_ready;
+assign udiv_src_valid = wait_src_ready;
+assign div_res_ready = wait_res_valid;
+assign udiv_res_ready = wait_res_valid;
+
+reg             init;
+reg             wait_src_ready;
+reg             wait_res_valid;
+reg             readygo;
 
 alu u_alu(
     .alu_op     (aluop),
@@ -48,12 +112,96 @@ alu u_alu(
     .alu_result (alu_result)
 );
 
+mydiv signed_div (
+    .aclk(clk),
+    .s_axis_divisor_tvalid(div_src_valid),
+    .s_axis_divisor_tready(div_src_1_ready),  
+    .s_axis_divisor_tdata(src2), 
+    .s_axis_dividend_tvalid(div_src_valid),
+    .s_axis_dividend_tready(div_src_2_ready),  
+    .s_axis_dividend_tdata(src1),  
+    .m_axis_dout_tvalid(div_res_valid),
+    .m_axis_dout_tdata(div_result)
+);
+
+unsigned_div unsigned_div (
+    .aclk(clk),
+    .s_axis_divisor_tvalid(udiv_src_valid),
+    .s_axis_divisor_tready(udiv_src_1_ready),  
+    .s_axis_divisor_tdata(src2), 
+    .s_axis_dividend_tvalid(udiv_src_valid),
+    .s_axis_dividend_tready(udiv_src_2_ready),  
+    .s_axis_dividend_tdata(src1),  
+    .m_axis_dout_tvalid(udiv_res_valid),
+    .m_axis_dout_tdata(udiv_result)
+);
+
+always @(posedge clk) begin
+        if (rst) begin
+                init <= 1'b1;
+        end
+        else if (readygo & MEM_allowin) begin
+                init <= 1'b1;
+        end
+        else begin
+                init <= 1'b0;
+        end
+end
+
+always @(posedge clk) begin
+        if (rst) begin
+                wait_src_ready <= 1'b0;
+        end
+        else if (init & div_or_udiv) begin
+                wait_src_ready <= 1'b1;
+        end
+        else if (wait_src_ready & src_ready) begin
+                wait_src_ready <= 1'b0;
+        end
+        else begin
+                wait_src_ready <= wait_src_ready;
+        end
+end
+
+always @(posedge clk) begin
+        if (rst) begin
+                wait_res_valid <= 1'b0;
+        end
+        else if (wait_src_ready & src_ready) begin
+                wait_res_valid <= 1'b1;
+        end
+        else if (wait_res_valid & res_valid) begin
+                wait_res_valid <= 1'b0;
+        end
+        else begin
+                wait_res_valid <= wait_res_valid;
+        end
+end
+
+always @(posedge clk) begin
+        if (rst) begin
+                readygo <= 1'b0;
+        end
+        else if (init & ~div_or_udiv | wait_res_valid & res_valid) begin
+                readygo <= 1'b1;
+        end
+        else if (readygo & MEM_allowin) begin
+                readygo <= 1'b0;
+        end
+        else begin
+                readygo <= readygo;
+        end
+end
+
 always @(posedge clk) begin
         if (rst) begin
                 EX_to_MEM_reg <= 138'b0;
         end
-        else if (MEM_allowin) begin
-                EX_to_MEM_reg <= {valid & ~rst, pc, IR, EX_to_MEM_zip, alu_result};
+        else if (readygo & MEM_allowin) begin
+                EX_to_MEM_reg <= {valid & ~rst, pc, IR, EX_to_MEM_zip, compute_result};
+        end
+        else if (~readygo & MEM_allowin) begin
+                EX_to_MEM_reg <= 138'b0;
         end
         else begin
                 EX_to_MEM_reg <= EX_to_MEM_reg;
diff --git a/Project-3/myCPU/ID.v b/Project-3/myCPU/ID.v
index 89353a2..2bd5529 100644
--- a/Project-3/myCPU/ID.v
+++ b/Project-3/myCPU/ID.v
@@ -23,7 +23,7 @@ module ID(
         output  wire [  4:0]    rf_raddr2,
         output  wire            flush,
         output  wire [ 31:0]    pc_real,
-        output  reg  [181:0]    ID_to_EX_reg
+        output  reg  [188:0]    ID_to_EX_reg
 );
 
 reg  [31:0]     last_pc;
@@ -125,8 +125,26 @@ wire            inst_bl;
 wire            inst_beq;
 wire            inst_bne;
 wire            inst_lu12i_w;
+wire            inst_slti;
+wire            inst_sltui;
+wire            inst_andi;
+wire            inst_ori;
+wire            inst_xori;
+wire            inst_sll;
+wire            inst_srl;
+wire            inst_sra;
+wire            inst_pcaddu12i;
+
+wire            inst_mul;
+wire            inst_mulh;
+wire            inst_mulhu;
+wire            inst_div;
+wire            inst_mod;
+wire            inst_divu;
+wire            inst_modu;
 
 wire            need_ui5;
+wire            need_ui12;
 wire            need_si12;
 wire            need_si16;
 wire            need_si20;
@@ -174,31 +192,52 @@ assign  inst_beq        = op_31_26_d[6'h16];
 assign  inst_bne        = op_31_26_d[6'h17];
 assign  inst_lu12i_w    = op_31_26_d[6'h05] & ~inst[25];
 
+assign  inst_slti       = op_31_26_d[6'h00] & op_25_22_d[4'h8];
+assign  inst_sltui      = op_31_26_d[6'h00] & op_25_22_d[4'h9];
+assign  inst_andi       = op_31_26_d[6'h00] & op_25_22_d[4'hd];
+assign  inst_ori        = op_31_26_d[6'h00] & op_25_22_d[4'he];
+assign  inst_xori       = op_31_26_d[6'h00] & op_25_22_d[4'hf];
+assign  inst_sll        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h0e];
+assign  inst_srl        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h0f];
+assign  inst_sra        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h10];
+assign  inst_pcaddu12i  = op_31_26_d[6'h07] & ~inst[25];
+
+assign  inst_mul        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h18];
+assign  inst_mulh       = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h19];
+assign  inst_mulhu      = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h1] & op_19_15_d[5'h1a];
+assign  inst_div        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h2] & op_19_15_d[5'h00];
+assign  inst_mod        = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h2] & op_19_15_d[5'h01];
+assign  inst_divu       = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h2] & op_19_15_d[5'h02];
+assign  inst_modu       = op_31_26_d[6'h00] & op_25_22_d[4'h0] & op_21_20_d[2'h2] & op_19_15_d[5'h03];
+
 assign  alu_op[ 0]      = inst_add_w | inst_addi_w | inst_ld_w | inst_st_w
-                         | inst_jirl | inst_bl;
+                         | inst_jirl | inst_bl | inst_pcaddu12i;
 assign  alu_op[ 1]      = inst_sub_w;
-assign  alu_op[ 2]      = inst_slt;
-assign  alu_op[ 3]      = inst_sltu;
-assign  alu_op[ 4]      = inst_and;
+assign  alu_op[ 2]      = inst_slt | inst_slti;
+assign  alu_op[ 3]      = inst_sltu | inst_sltui;
+assign  alu_op[ 4]      = inst_and | inst_andi;
 assign  alu_op[ 5]      = inst_nor;
-assign  alu_op[ 6]      = inst_or;
-assign  alu_op[ 7]      = inst_xor;
-assign  alu_op[ 8]      = inst_slli_w;
-assign  alu_op[ 9]      = inst_srli_w;
-assign  alu_op[10]      = inst_srai_w;
+assign  alu_op[ 6]      = inst_or | inst_ori;
+assign  alu_op[ 7]      = inst_xor | inst_xori;
+assign  alu_op[ 8]      = inst_slli_w | inst_sll;
+assign  alu_op[ 9]      = inst_srli_w | inst_srl;
+assign  alu_op[10]      = inst_srai_w | inst_sra;
 assign  alu_op[11]      = inst_lu12i_w;
 
 assign  need_ui5        =  inst_slli_w | inst_srli_w | inst_srai_w;
-assign  need_si12       =  inst_addi_w | inst_ld_w | inst_st_w;
+assign  need_ui12       =  inst_andi | inst_ori | inst_xori;//
+assign  need_si12       =  inst_addi_w | inst_ld_w | inst_st_w | inst_slti | inst_sltui;
 assign  need_si16       =  inst_jirl | inst_beq | inst_bne;
-assign  need_si20       =  inst_lu12i_w;
+assign  need_si20       =  inst_lu12i_w | inst_pcaddu12i;
 assign  need_si26       =  inst_b | inst_bl;
 assign  src2_is_4       =  inst_jirl | inst_bl;
 
-assign  imm             = src2_is_4 ? 32'h4                      :
-                          need_si20 ? {i20[19:0], 12'b0}         :
+assign imm = src2_is_4 ? 32'h4 :
+             need_si20 ? {i20[19:0], 12'b0} :
+             need_ui12 ? {{20'b0}, i12} :
              /*need_ui5 || need_si12*/{{20{i12[11]}}, i12[11:0]} ;
 
+
 assign  br_offs         = need_si26 ? {{ 4{i26[25]}}, i26[25:0], 2'b0} :
                              {{14{i16[15]}}, i16[15:0], 2'b0} ;
 
@@ -206,7 +245,7 @@ assign  jirl_offs       = {{14{i16[15]}}, i16[15:0], 2'b0};
 
 assign  src_reg_is_rd   = inst_beq | inst_bne | inst_st_w;
 
-assign  src1_is_pc      = inst_jirl | inst_bl;
+assign  src1_is_pc      = inst_jirl | inst_bl | inst_pcaddu12i;
 
 assign  src2_is_imm     = inst_slli_w |
                           inst_srli_w |
@@ -216,7 +255,13 @@ assign  src2_is_imm     = inst_slli_w |
                           inst_st_w   |
                           inst_lu12i_w|
                           inst_jirl   |
-                          inst_bl     ;
+                          inst_bl     |
+                          inst_slti   |
+                          inst_sltui  |
+                          inst_andi   |
+                          inst_ori    |
+                          inst_xori   |
+                          inst_pcaddu12i ;
 
 assign  res_from_mem    = inst_ld_w;
 assign  dst_is_r1       = inst_bl;
@@ -250,7 +295,7 @@ assign  flush           = ((br_taken ^ predict) | inst_jirl) & ~rst & valid;
 
 always @(posedge clk) begin
         if (rst) begin
-                ID_to_EX_reg <= 182'b0;
+                ID_to_EX_reg <= 189'b0;
         end
         else if (EX_allowin & readygo) begin
                 ID_to_EX_reg <= {
@@ -258,11 +303,12 @@ always @(posedge clk) begin
                         pc, inst,
                         src1_is_pc ? pc : rj_value,
                         src2_is_imm ? imm : rkd_value,
-                        alu_op, inst_ld_w, mem_we, res_from_mem, gr_we, rkd_value, dest
+                        alu_op, inst_ld_w, mem_we, res_from_mem, gr_we, rkd_value, dest,
+                        inst_mul, inst_mulh, inst_mulhu, inst_div, inst_mod, inst_divu, inst_modu
                         };
         end
         else if (EX_allowin & ~readygo) begin
-                ID_to_EX_reg <= 182'b0;
+                ID_to_EX_reg <= 189'b0;
         end
         else begin
                 ID_to_EX_reg <= ID_to_EX_reg;
diff --git a/Project-3/myCPU/MEM.v b/Project-3/myCPU/MEM.v
index 2c055fb..25c0b81 100644
--- a/Project-3/myCPU/MEM.v
+++ b/Project-3/myCPU/MEM.v
@@ -48,7 +48,7 @@ always @(posedge clk) begin
         if (rst) begin
                 readygo <= 1'b0;
         end
-        else if (~readygo & (data_ready | data_valid)) begin
+        else if (~readygo & (data_ready | data_valid) & valid) begin
                 readygo <= 1'b1;
         end
         else if (readygo & WB_allowin) begin
diff --git a/Project-3/myCPU/mycpu_top.v b/Project-3/myCPU/mycpu_top.v
index 6f599fa..11bc21e 100644
--- a/Project-3/myCPU/mycpu_top.v
+++ b/Project-3/myCPU/mycpu_top.v
@@ -42,7 +42,7 @@ assign data_valid = 1'b1;
 
 // internal pipeline zipes
 wire [64:0]  IF_to_ID_reg;
-wire [181:0] ID_to_EX_reg;
+wire [188:0] ID_to_EX_reg;
 wire [137:0] EX_to_MEM_reg;
 wire [102:0] MEM_to_WB_reg;
 
